{"version":3,"file":"userinfo.js","sources":["graphs/userTimeOnline.js"],"names":[],"mappings":"AAAA,OAAA,2BAAA,WAEA,GAAA,IAAA,IAAA,GAAA,MAAA,GAAA,OAAA,GAAA,KAAA,IACA,EAAA,IAAA,EAAA,KAAA,EAAA,MACA,EAAA,IAAA,EAAA,IAAA,EAAA,OAIA,GAFA,GAAA,OAAA,OAEA,GAAA,MAAA,UACA,iBAAA,EAAA,GAAA,GAAA,IAEA,EAAA,GAAA,MAAA,SACA,OAAA,EAAA,IAEA,EAAA,GAAA,IAAA,OACA,MAAA,GACA,OAAA,UAEA,EAAA,EAAA,cAAA,KAAA,QAEA,EAAA,GAAA,OAAA,gBAAA,OAAA,OACA,KAAA,QAAA,EAAA,EAAA,KAAA,EAAA,OACA,KAAA,SAAA,EAAA,EAAA,IAAA,EAAA,QACA,OAAA,KACA,KAAA,YAAA,aAAA,EAAA,KAAA,IAAA,EAAA,IAAA,IAEA,IAAA,KAAA,sBAAA,EAAA,SAAA,EAAA,GAmCA,QAAA,KACA,aAAA,EAGA,IAAA,GAAA,EAAA,OAAA,EAAA,KAAA,KAAA,QACA,SAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,MACA,SAAA,EAAA,GAAA,MAAA,IAAA,UAAA,EAAA,KAAA,EAAA,QACA,IAAA,SAAA,GAAA,MAAA,GAAA,QACA,OAEA,EAAA,EAAA,aAAA,SAAA,KACA,EAAA,SAAA,EAAA,GAAA,MAAA,IAAA,EAEA,GAAA,UAAA,QACA,MAAA,GACA,KAAA,IAAA,SAAA,GAAA,MAAA,GAAA,EAAA,QAEA,EAAA,OAAA,WACA,KAAA,GACA,UAAA,KACA,MAAA,GArDA,EAAA,QAAA,SAAA,GACA,EAAA,WAAA,EAAA,YAGA,EAAA,OAAA,EAAA,IAAA,SAAA,GAAA,MAAA,GAAA,QACA,EAAA,QAAA,EAAA,GAAA,IAAA,EAAA,SAAA,GAAA,MAAA,GAAA,SAEA,EAAA,OAAA,KACA,KAAA,QAAA,UACA,KAAA,YAAA,kBAAA,EAAA,IAAA,KACA,KAAA,GACA,UAAA,QACA,KAAA,YAAA,WACA,MAAA,gBAGA,EAAA,UAAA,QACA,KAAA,GACA,QAAA,OAAA,QACA,KAAA,QAAA,OACA,KAAA,IAAA,SAAA,GAAA,MAAA,GAAA,EAAA,QACA,KAAA,QAAA,EAAA,aACA,KAAA,IAAA,SAAA,GAAA,MAAA,GAAA,EAAA,QACA,KAAA,SAAA,SAAA,GAAA,MAAA,GAAA,EAAA,EAAA,QACA,OAAA,aACA,KAAA,SAAA,GAAA,MAAA,GAAA,KAAA,MAEA,GAAA,OAAA,SAAA,GAAA,SAAA,EAEA,IAAA,GAAA,WAAA,WACA,GAAA,OAAA,SAAA,SAAA,WAAA,GAAA,KAAA,IACA,SA0BA,SArFA,yBAAA,cAIA,OAAA,WAAA","sourcesContent":["define('graphs/userTimeOnline',[],function() {\r\n\r\nvar margin = {top: 20, right: 20, bottom: 60, left: 40},\r\n    width = 500 - margin.left - margin.right,\r\n    height = 200 - margin.top - margin.bottom;\r\n\r\nvar formatPercent = d3.format(\".0%\");\r\n\r\nvar x = d3.scale.ordinal()\r\n    .rangeRoundBands([0, width], .1, 1);\r\n\r\nvar y = d3.scale.linear()\r\n    .range([height, 0]);\r\n\r\nvar xAxis = d3.svg.axis()\r\n    .scale(x)\r\n    .orient(\"bottom\");\r\n\r\nvar user = $('.page-wrap').data('user');\r\n\r\nvar svg = d3.select(\".time-online\").append(\"svg\")\r\n    .attr(\"width\", width + margin.left + margin.right)\r\n    .attr(\"height\", height + margin.top + margin.bottom)\r\n  .append(\"g\")\r\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\r\n\r\nd3.json(\"/getusertimeonline/\" + user, function(error, data) {\r\n\r\n\t  data.forEach(function(d) {\r\n\t    d.frequency = +d.frequency;\r\n\t  });\r\n\r\n\t  x.domain(data.map(function(d) { return d.time; }));\r\n\t  y.domain([0, d3.max(data, function(d) { return d.perc; })]);\r\n\r\n\t  svg.append(\"g\")\r\n\t      .attr(\"class\", \"x axis\")\r\n\t      .attr(\"transform\", \"translate(-10,\" + (height + 30)+ \")\")\r\n\t      .call(xAxis)\r\n\t      .selectAll('text')\r\n\t      \t\t.attr(\"transform\", function(d) {\r\n                \treturn \"rotate(-90)\" \r\n                })\r\n\r\n\t  svg.selectAll(\".bar\")\r\n\t      .data(data)\r\n\t    .enter().append(\"rect\")\r\n\t      .attr(\"class\", \"bar\")\r\n\t      .attr(\"x\", function(d) { return x(d.time); })\r\n\t      .attr(\"width\", x.rangeBand())\r\n\t      .attr(\"y\", function(d) { return y(d.perc); })\r\n\t      .attr(\"height\", function(d) { return height - y(d.perc); })\r\n\t    .append(\"svg:title\")\r\n\t    \t.text(function(d, i) { return d.perc + '%'; })\r\n\r\n\t  d3.select(\"input\").on(\"change\", change);\r\n\r\n\t  var sortTimeout = setTimeout(function() {\r\n\t    d3.select(\"input\").property(\"checked\", true).each(change);\r\n\t  }, 2000);\r\n\r\n\t  function change() {\r\n\t    clearTimeout(sortTimeout);\r\n\r\n\t    // Copy-on-write since tweens are evaluated after a delay.\r\n\t    var x0 = x.domain(data.sort(this.checked\r\n\t        ? function(a, b) { return b.perc - a.perc; }\r\n\t        : function(a, b) { return d3.ascending(a.perc, b.perc); })\r\n\t        .map(function(d) { return d.time; }))\r\n\t        .copy();\r\n\r\n\t    var transition = svg.transition().duration(750),\r\n\t        delay = function(d, i) { return i * 50; };\r\n\r\n\t    transition.selectAll(\".bar\")\r\n\t        .delay(delay)\r\n\t        .attr(\"x\", function(d) { return x0(d.time); });\r\n\r\n\t    transition.select(\".x.axis\")\r\n\t        .call(xAxis)\r\n\t      .selectAll(\"g\")\r\n\t        .delay(delay);\r\n\t  }\r\n\t});\r\n});\n"]}